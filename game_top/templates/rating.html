{% extends 'base.html'%}

{% block content %}
<div class="rating-page">
<div class="container-rate">
    <div class="form-header">
        <span class="help-icon">?</span>
        <div class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <div class="criteria-description">
                    <div class="criteria-item">
                        <div class="criteria-number">1</div>
                        <div class="criteria-content">
                            <h3>ОРИГИНАЛЬНОСТЬ:</h3>
                            <p>Оценка включает уникальность игровых механик, свежесть идей и инновационный подход. Высший балл получают проекты, предлагающие что-то действительно новое в жанре или создающие свой собственный поджанр. При этом простое копирование существующих механик может получить минимальную оценку.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">2</div>
                        <div class="criteria-content">
                            <h3>ГЕЙМПЛЕЙ:</h3>
                            <p>Оценка включает в себя совокупность двух параметров: 1. Механики - качество и разнообразие игровых механик, их взаимодействие между собой 2. Баланс - насколько хорошо сбалансированы все элементы игры для создания увлекательного игрового процесса.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">3</div>
                        <div class="criteria-content">
                            <h3>СЮЖЕТ:</h3>
                            <p>Оценка охватывает качество повествования, глубину проработки персонажей и мира, логичность развития событий. Учитывается как основная сюжетная линия, так и побочные квесты, предыстория мира и дополнительные сюжетные материалы. Высокие баллы получают игры с оригинальным, глубоким и последовательным повествованием.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">4</div>
                        <div class="criteria-content">
                            <h3>ТЕХНИЧЕСКОЕ СОСТОЯНИЕ:</h3>
                            <p> Оценка включает стабильность работы игры, наличие или отсутствие багов, оптимизацию и производительность. Максимальный балл получают технически безупречные проекты.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">5</div>
                        <div class="criteria-content">
                            <h3>ГРАФИКА/ВИЗУАЛЬНЫЙ СТИЛЬ:</h3>
                            <p> Оценивается не только технологическая составляющая графики, но и общая визуальная эстетика, художественный стиль, дизайн персонажей и окружения. Высокие оценки могут получить как технологически продвинутые проекты, так и игры с уникальным художественным видением.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">6</div>
                        <div class="criteria-content">
                            <h3>ЗВУКИ:</h3>
                            <p>Оценка включает качество звуковых эффектов, их уместность и разнообразие. Учитывается реалистичность или стилистическое соответствие звуков, качество озвучки персонажей и общее звуковое оформление игрового мира.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">7</div>
                        <div class="criteria-content">
                            <h3>МУЗЫКА:</h3>
                            <p> Оценивается качество музыкального сопровождения, его соответствие атмосфере игры и ситуациям. Учитывается как оригинальный саундтрек, так и подбор лицензированной музыки, если она используется. Важны разнообразие композиций и их способность усиливать эмоциональное воздействие игры.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">8</div>
                        <div class="criteria-content">
                            <h3>ДИЗАЙН:</h3>
                            <p>Оценка охватывает три ключевых аспекта: 1. Геймдизайн - проработанность игровых механик, их взаимодействие между собой, баланс сложности, выстраивание кривой обучения игрока, продуманность систем прогрессии и вознаграждений 2. Левел-дизайн - качество проектирования игровых локаций, их структура и планировка, расположение препятствий и наград, организация игрового пространства для создания интересных игровых ситуаций, темпоритм прохождения 3. UI/UX дизайн - качество пользовательского интерфейса, удобство меню, интуитивность навигации и общая эргономика. Высокие баллы получают проекты, где все аспекты дизайна работают гармонично, создавая комфортный и увлекательный игровой опыт.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">9</div>
                        <div class="criteria-content">
                            <h3>АТМОСФЕРА:</h3>
                            <p> Оценивается способность игры создавать определённое настроение и погружать игрока в свой мир. Учитывается совокупность всех элементов: визуальный стиль, звук, музыка, повествование и их гармоничное взаимодействие для создания целостной атмосферы.</p>
                        </div>
                    </div>

                    <div class="criteria-item">
                        <div class="criteria-number">10</div>
                        <div class="criteria-content">
                            <h3>ОБЩЕЕ ВПЕЧАТЛЕНИЕ:</h3>
                            <p> Субъективная оценка, отражающая общее восприятие игры как целостного произведения. Учитывается, насколько успешно игра достигает поставленных целей, насколько запоминающимся получился опыт и какое послевкусие оставляет проект после прохождения. </p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
<form method="post">
<div class="criteria-name">
            <h3>Название игры:</h3>
            {{ form.game_name() }}
        </div>
    <div class="criteria-container">
    <div class="criteria">
    <h3>Оригинальность:</h3>
    {{ form.originality() }} {{ form.hidden_tag() }}
    <span id="originalityValue">{{ form.originality.data }}</span>
    <p id="originality-description"></p>
</div>

<div class="criteria">
    <h3>Геймплей:</h3>
    {{ form.gameplay() }} {{ form.hidden_tag() }}
    <span id="gameplayValue">{{ form.gameplay.data }}</span>
    <p id="gameplay-description"></p>
</div>
            <div class="criteria">
                <h3> Сюжет:</h3>
                {{ form.story() }} {{ form.hidden_tag() }}
                <span id="storyValue"> {{ form.story.data }}</span>
                <p id="story-description"></p>
            </div>
            <div class="criteria">
                <h3> Техническое состояние:</h3>
                {{ form.bugs() }} {{ form.hidden_tag() }}
                <span id="bugsValue"> {{ form.bugs.data }}</span>
                <p id="bugs-description"></p>
            </div>
            <div class="criteria">
                <h3> Графика/виз.стиль:</h3>
                {{ form.graphics() }} {{ form.hidden_tag() }}
                <span id="graphicsValue"> {{ form.graphics.data }}</span>
                <p id="graphics-description"></p>
            </div>
            <div class="criteria">
                <h3> Звуки:</h3>
                {{ form.sound() }} {{ form.hidden_tag() }}
                <span id="soundValue"> {{ form.sound.data }}</span>
                <p id="sound-description"></p>
            </div>
            <div class="criteria">
                <h3> Музыка:</h3>
                {{ form.music() }} {{ form.hidden_tag() }}
                <span id="musicValue"> {{ form.music.data }}</span>
                <p id="music-description"></p>
            </div>
            <div class="criteria">
                <h3> Дизайн:</h3>
                {{ form.design() }} {{ form.hidden_tag() }}
                <span id="designValue"> {{ form.design.data }}</span>
                <p id="design-description"></p>
            </div>
            <div class="criteria">
                <h3> Атмосфера:</h3>
                {{ form.atmosphere() }} {{ form.hidden_tag() }}
                <span id="atmosphereValue"> {{ form.atmosphere.data }}</span>
                <p id="atmosphere-description"></p>
            </div>
        <div class="criteria">
                <h3> Общее впечатление:</h3>
                {{ form.general_impression() }} {{ form.hidden_tag() }}
                <span id="general_impressionValue"> {{ form.general_impression.data }}</span>
            <p id="general_impression-description"></p>
            </div>
    </div>
    {{ form.submit() }}
</form>
<p id="totalScore" class="score-circle" align="center"></p>
</div>
</div>


<script>
// Объект с описаниями для каждого критерия
const criteriaDescriptions = {
    originality: {
        '0-2': 'Полное копирование существующих механик без каких-либо изменений. Клон популярной игры без собственных идей.',
        '3-4': 'Минимальные изменения существующих механик. Комбинация известных элементов без значительных инноваций.',
        '5-6': 'Интересные вариации на известные механики. Несколько свежих идей в рамках устоявшегося жанра.',
        '7-8': 'Существенные инновации в рамках жанра. Оригинальные механики и свежий подход к известным элементам.',
        '9-10': 'Революционные идеи или идеи, создающие новый поджанр/жанр. Уникальные механики, не имеющие прямых аналогов.'
    },
    gameplay: {
        '0-2': 'Нефункциональные или плохо реализованные механики. Полное отсутствие баланса.',
        '3-4': 'Базовые механики работают, но они однообразны. Существенные проблемы с балансом.',
        '5-6': 'Механики работают хорошо, но могут быть однообразными. Баланс требует доработки, но игра проходима.',
        '7-8': 'Разнообразные, хорошо проработанные механики. Качественный баланс с минимальными недочетами.',
        '9-10': 'Безупречно работающие, многогранные механики. Идеальный баланс всех игровых элементов.'
    },
    story: {
        '0-2': 'Отсутствие связного повествования. Бессмысленный или противоречивый сюжет.',
        '3-4': 'Примитивный, шаблонный сюжет. Слабая проработка персонажей и мира.',
        '5-6': 'Стандартный, но качественный сюжет. Достаточная проработка основных элементов.',
        '7-8': 'Увлекательное повествование с хорошо прописанными персонажами и миром.',
        '9-10': 'Выдающийся, многослойный сюжет. Глубокая проработка всех элементов повествования.'
    },
    bugs: {
        '0-2': 'Критические баги, делающие игру непроходимой. Частые вылеты и зависания.',
        '3-4': 'Множество заметных багов. Серьезные проблемы с производительностью.',
        '5-6': 'Несколько заметных багов. Средняя оптимизация.',
        '7-8': 'Минимальное количество некритичных багов. Хорошая оптимизация.',
        '9-10': 'Отсутствие заметных багов. Безупречная оптимизация.'
    },
    graphics: {
        '0-2': 'Визуально непривлекательная графика/Отсутствие целостного стиля.',
        '3-4': 'Устаревшая или некачественная графика/Базовый, неоригинальный стиль.',
        '5-6': 'Приемлемое качество графики/Последовательный, хотя и не выдающийся стиль.',
        '7-8': 'Качественная графика/Привлекательный и оригинальный визуальный стиль.',
        '9-10': 'Исключительное качество графики/Уникальный, запоминающийся стиль.'
    },
    sound: {
        '0-2': 'Некачественные или отсутствующие звуковые эффекты. Плохая озвучка.',
        '3-4': 'Базовые звуковые эффекты. Посредственная озвучка.',
        '5-6': 'Качественные базовые звуки. Приемлемая озвучка.',
        '7-8': 'Разнообразные, качественные звуки. Хорошая озвучка.',
        '9-10': 'Исключительное качество всех звуковых элементов. Выдающаяся озвучка.'
    },
    music: {
        '0-2': 'Раздражающая или неуместная музыка. Очень ограниченный набор композиций.',
        '3-4': 'Посредственный саундтрек. Малое разнообразие композиций.',
        '5-6': 'Приятная, но не запоминающаяся музыка. Достаточное разнообразие.',
        '7-8': 'Качественный саундтрек, усиливающий атмосферу игры.',
        '9-10': 'Выдающийся саундтрек, становящийся неотъемлемой частью игрового опыта.'
    },
    design: {
        '0-2': 'Непродуманный геймдизайн. Плохой левел-дизайн. Неудобный интерфейс.',
        '3-4': 'Базовый геймдизайн. Простой левел-дизайн. Функциональный, но неудобный UI.',
        '5-6': 'Хороший базовый дизайн во всех аспектах, но без особых достоинств.',
        '7-8': 'Качественный дизайн во всех аспектах. Продуманная структура и удобный UI.',
        '9-10': 'Исключительный дизайн во всех аспектах, создающий безупречный игровой опыт.'
    },
    atmosphere: {
        '0-2': 'Отсутствие атмосферы. Разрозненные элементы не создают целостного впечатления.',
        '3-4': 'Слабая атмосфера. Элементы плохо работают вместе.',
        '5-6': 'Ощутимая атмосфера. Большинство элементов работают согласованно.',
        '7-8': 'Сильная, захватывающая атмосфера. Отличное взаимодействие всех элементов.',
        '9-10': 'Незабываемая атмосфера, полностью погружающая игрока в игровой мир.'
    },
    general_impression: {
        '0-2': 'Крайне негативное впечатление. Игра не достигает ни одной из поставленных целей.',
        '3-4': 'Слабое впечатление. Игра едва достигает минимальных целей.',
        '5-6': 'Нейтральное или умеренно положительное впечатление. Игра достигает базовых целей.',
        '7-8': 'Сильное положительное впечатление. Игра успешно достигает большинства целей.',
        '9-10': 'Исключительное впечатление. Игра превосходит ожидания и оставляет яркое послевкусие.'
    }
};

// Функция для получения диапазона значения
function getValueRange(value) {
    if (value <= 2) return '0-2';
    if (value <= 4) return '3-4';
    if (value <= 6) return '5-6';
    if (value <= 8) return '7-8';
    return '9-10';
}

// Функция обновления значений
function updateValue(element, isAutoUpdate = false) {
    const id = element.id + "Value";
    const valueElement = document.getElementById(id);
    const newValue = parseInt(element.value);

    // Обновляем числовое значение
    valueElement.innerText = newValue;

    // Обновляем текстовое описание
    const descriptionElement = document.querySelector(`#${element.id}-description`);
    if (descriptionElement && criteriaDescriptions[element.id]) {
        const range = getValueRange(newValue);
        descriptionElement.innerText = criteriaDescriptions[element.id][range];
    }

    // Если изменение не было вызвано автоматическим обновлением атмосферы
    // и изменился один из компонентов атмосферы, обновляем значение атмосферы
    if (!isAutoUpdate && ['graphics', 'sound', 'music', 'story'].includes(element.id)) {
        updateAtmosphere();
    }

    updateTotalScore();
}

// Функция автоматического обновления атмосферы
function updateAtmosphere() {
    const graphics = parseInt(document.getElementById('graphics').value || 0);
    const sound = parseInt(document.getElementById('sound').value || 0);
    const music = parseInt(document.getElementById('music').value || 0);
    const story = parseInt(document.getElementById('story').value || 0);

    // Вычисляем среднее значение и округляем до целого числа
    const atmosphereValue = Math.round((graphics + sound + music + story) / 4);

    // Получаем элемент слайдера атмосферы
    const atmosphereSlider = document.getElementById('atmosphere');

    // Устанавливаем новое значение
    atmosphereSlider.value = atmosphereValue;

    // Обновляем отображение значения, передавая true чтобы избежать рекурсии
    updateValue(atmosphereSlider, true);

    // Делаем слайдер атмосферы неактивным
    atmosphereSlider.disabled = true;
}

// Функция обновления общего счета
function updateTotalScore() {
    const criteria = [
        'originality', 'gameplay', 'story', 'bugs',
        'graphics', 'sound', 'music', 'design',
        'atmosphere', 'general_impression'
    ];

    const totalScore = criteria.reduce((sum, criterion) => {
        return sum + parseInt(document.getElementById(criterion).value || 0);
    }, 0);

    const scoreElement = document.getElementById('totalScore');
    scoreElement.innerText = totalScore;

    const maxScore = criteria.length * 10;
    const percentage = (totalScore / maxScore) * 100;

    // Удаляем предыдущие классы
    scoreElement.classList.remove('low-score', 'medium-score', 'high-score', 'perfect-score');

    // Применяем соответствующий класс в зависимости от оценки
    if (totalScore === maxScore) {
        scoreElement.classList.add('perfect-score');
    } else if (percentage >= 70) {
        scoreElement.classList.add('high-score');
    } else if (percentage >= 40) {
        scoreElement.classList.add('medium-score');
    } else {
        scoreElement.classList.add('low-score');
    }
}

// Инициализация при загрузке страницы
document.addEventListener('DOMContentLoaded', () => {
    const ranges = document.querySelectorAll('input[type="range"]');
    ranges.forEach(range => {
        // Добавляем обработчик события input для каждого слайдера
        range.addEventListener('input', () => updateValue(range));
        // Инициализируем начальные значения
        updateValue(range);
    });

    // Добавляем плавное появление
    const container = document.querySelector('.container-rate');
    if (container) {
        container.style.opacity = '0';
        requestAnimationFrame(() => {
            container.style.transition = 'opacity 0.3s ease';
            container.style.opacity = '1';
        });
    }

    // Делаем слайдер атмосферы неактивным при загрузке
    const atmosphereSlider = document.getElementById('atmosphere');
    if (atmosphereSlider) {
        atmosphereSlider.disabled = true;
        // Инициализируем начальное значение атмосферы
        updateAtmosphere();
    }

    // Инициализация модального окна
    const helpIcon = document.querySelector('.help-icon');
    const modal = document.querySelector('.modal');
    const closeBtn = document.querySelector('.close-btn');

    if (helpIcon && modal && closeBtn) {
        helpIcon.addEventListener('click', () => {
            modal.style.display = 'block';
        });

        closeBtn.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });
    }
});


</script>


{% endblock %}

